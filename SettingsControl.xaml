<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="DocSpy.SettingsControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DocSpy"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:controls="using:CommunityToolkit.WinUI.Controls" 
    xmlns:ui="using:CommunityToolkit.WinUI"
    mc:Ignorable="d">

    <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <TextBlock TextWrapping="Wrap" Text="Settings" Style="{ThemeResource TitleTextBlockStyle}" Padding="12" />
        <controls:SettingsExpander Header="Sites File"                                 
                               Description="This file contains the sites that DocSpy will display."
                               HeaderIcon= "{ui:FontIcon Glyph=&#xEC4E;}" VerticalAlignment="Top" HorizontalAlignment="Stretch"
                               IsExpanded="{x:Bind local:Settings.Instance.ViewModel.HasConfigFilePath, Mode=OneWay}"
                                   Margin="12">
            <controls:SettingsExpander.Resources>
                <x:Double x:Key="SettingsCardWrapThreshold">800</x:Double>
                <x:Double x:Key="SettingsCardWrapNoIconThreshold">600</x:Double>
            </controls:SettingsExpander.Resources>

            <Grid VerticalAlignment="Bottom" HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <AutoSuggestBox Grid.Column="0" x:Name="ConfigFileEdit" HorizontalAlignment="Stretch" VerticalAlignment="Top" MinWidth="300" 
                         MaxWidth="800" Text="{x:Bind local:Settings.Instance.ViewModel.ConfigFilePath, Mode=TwoWay}" 
                    TextChanged="ConfigFileEdit_TextChanged" SuggestionChosen="ConfigFileEdit_SuggestionChosen" GotFocus="ConfigFileEdit_GotFocus" LostFocus="ConfigFileEdit_LostFocus" />
                <Button  Grid.Column="2" x:Name="PickConfigButton" Content="{ui:FontIcon Glyph=&#xE838;}" VerticalAlignment="Bottom"
            Click="PickConfigButton_Click" Margin="0,0,0,12"/>
                <Button  Grid.Column="1" x:Name="EditConfigButton" Content="{ui:FontIcon Glyph=&#xE70F;}" VerticalAlignment="Bottom"
            Click="EditConfigButton_Click" Margin="0,0,0,12" IsEnabled="{x:Bind local:Settings.Instance.ViewModel.ConfigFilePathExists, Mode=OneWay}"/>
            </Grid>
            <controls:SettingsExpander.Items>
                <controls:SettingsCard Header="Create new sites file" Description="Click here if you don't have a sites file" 
                                   VerticalAlignment="Top" HorizontalAlignment="Stretch">
                    <Button x:Name="CreateNewConfigButton" Content="Create New" HorizontalAlignment="Stretch" Click="CreateNewConfigButton_Click"/>
                </controls:SettingsCard>
            </controls:SettingsExpander.Items>
        </controls:SettingsExpander>
        <Button x:Name="OkButton" Content="Ok" Click="OkButton_Click" Style="{ThemeResource AccentButtonStyle}"
                Margin="12" Width="100" HorizontalAlignment="Right" VerticalAlignment="Bottom"></Button>
    </StackPanel>
</UserControl>
